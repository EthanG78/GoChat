<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>GoChat</title>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js" type= "text/javascript"></script>
        <script type="text/javascript">
           $(function () {

              var conn;
              var msg = $("#msg");
              var log = $("#log");

              function appLog(msg) {
                 var d = log[0];
                 var doScroll = d.scrollTop == d.scrollHeight - d.clientHeight;
                 msg.append(log);
                 if (doScroll) {
                    d.scrollTop = d.scrollHeight - d.clientHeight;
                 }
              }

              $("#form").submit(function () {
                 if (!conn) {
                    return false;
                 }
                 if (!msg.val()) {
                    return false;
                 }
                 conn.send(msg.val());
                 msg.val("");
                 return false;
              });

              if (window["WebSocket"]) {
                 conn = new WebSocket("ws://localhost:8080/ws");
                 conn.onclose = function (evt) {
                    appLog($("<div><b>Connection Closed.<\/b><\/div>"));

                 };
                 conn.onmessage = function (evt) {
                    appLog($("<div/>").text(evt.data));
                 }

              } else {
                 appLog($("<div><b>Your browser does not support WebSockets.<\/b><\/div>"));
              }
           });
        </script>
        <link rel="stylesheet" type="text/css" href="css/main.css">
    </head>
    <body>
        <div id="log"></div>
            <form id="form" name="form">
                <input type="submit" value="Send"> <input id="msg" size="64" type="text">
            </form>

    </body>
</html>